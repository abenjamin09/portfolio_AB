(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{1012:function(e,t,o){e.exports=o(1016)},1016:function(e,t,o){"use strict";o.r(t);var n=o(4),r=o.n(n),i=(o(16),o(49),o(87),o(525),o(120),o(2)),a=o.n(i),s=o(29),c=o(10),l=(o(13),o(80),o(0)),d=function(){};(d.prototype=new c.a).constructor=d,d.prototype.verifyPhone=function(e,t,o){var n={};return n.url=l.a.urlContext+"/auth/verify/phone/securitycode"+l.a.referrerQuery,n.data=JSON.stringify({phoneNumber:{id:e},securityCode:{code:t},mode:o}),n.headers={Accept:"application/json"},this.post(n)},d.prototype.verifyDevice=function(e){var t={};return t.data=JSON.stringify({securityCode:{code:e}}),t.url=l.a.urlContext+"/auth/verify/trusteddevice/securitycode"+l.a.referrerQuery,t.headers={Accept:"application/json"},this.post(t)},d.prototype.sendNewCode=function(e,t){var o={url:l.a.urlContext+"/auth/verify/phone",data:JSON.stringify({phoneNumber:{id:e},mode:t}),headers:{Accept:"application/json"}};return this.put(o)};var u=new d,h=o(33),p=o(3),f=o(18),g=o(109),v=o(190);function w(e,t,o,n,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(n,r)}function m(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"post",n=document.createElement("form");for(var r in n.method=o,n.action=e,n.target="_blank",t)if(t.hasOwnProperty(r)){var i=document.createElement("input");i.type="hidden",i.name=r,i.value=t[r],n.appendChild(i)}document.body.appendChild(n),n.submit(),document.body.removeChild(n)}var M=function(){var e,t=(e=regeneratorRuntime.mark((function e(t,o,n){var r,i,a,c,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.a.getRedirectUrl("/auth/account/recovery");case 3:r=e.sent,i=Object(s.a)(r,"jqXHR",{}),"string"==typeof(a=i.getResponseHeader("Location"))&&""!==a.trim()&&(c={redirectURL:a,returnUrl:Object(s.a)(l.a,"envConfigFromConsumer.returnUrl","#"),refererUrl:Object(s.a)(l.a,"refererUrl","#"),destinationDomain:Object(s.a)(l.a,"envConfigFromConsumer.returnUrl","#")},Object(s.a)(l.a,"envConfigFromConsumer.requestorContext",void 0)&&(c.requestorContext=l.a.envConfigFromConsumer.requestorContext),d=Object(g.a)(c),o.attr("dialog.moreVerificationOptions.links.recovery",d),200===i.status?m(d,i.responseJSON):t.target.href=d),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),n(Object(s.a)(e.t0,"jqXHR",{}),o),t.preventDefault();case 13:case"end":return e.stop()}}),e,null,[[0,9]])})),function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){w(i,n,r,a,s,"next",e)}function s(e){w(i,n,r,a,s,"throw",e)}a(void 0)}))});return function(e,o,n){return t.apply(this,arguments)}}(),y=o(572),b=o.n(y),S=o(20);function C(e,t,o,n,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(n,r)}var P=function(e,t){var o=null;return 1===t.length?o=t[0]:r.a.each(t,(function(t,n){t.id==e&&(o=t)})),o},T=function(e,t){r.a.each(e.phones,(function(o,n){o.id!==e.selectedPhone.id&&o.attr("disable",t)}))},O=function(e,t){var o=a()("phones"),n=Object(f.a)(e.responseJSON,p.a.getString("fallback"));switch(e.status){case 400:t.attr("errorMessage",n.message);break;case 409:o.trigger("next_409",[e]);break;case 423:n.status.isTooManyCodesSent&&t.attr("lastCodeSentTo.errorMessage",p.a.getString("tooManyCodesSent")),(n.status.isTooManyCodesValidated||n.status.isSecurityCodeLocked)&&t.attr("lastCodeSentTo.errorMessage",p.a.getString("securityCodeLocked")),o.trigger("phoneSelected",[e,t.attr("lastCodeSentTo")]);break;default:t.attr("errorMessage",n.message)}},k=(r.a.Component.extend({tag:"phones",template:r.a.view(b.a),viewModel:{define:{appleIdLinkTarget:{type:"string",value:function(){return l.a.appleIdLinkTarget}},recoveryNotAvailableLink:{type:"boolean",get:function(){return!(!this.attr("twoFactorVerificationSupportUrl")||this.attr("recoveryAvailable"))}}},mode:Object(s.a)(l.a,"envConfigFromConsumer.authUIMode"),twoFactorVerificationSupportUrl:"",recoveryAvailable:!0,phones:{},lastCodeSentTo:null,isSendCodeLocked:!1,errorMessage:"",verifyMode:"",suppressIforgot:null,selectedPhone:null,showHelpDialog:!1,dialog:{moreVerificationOptions:{links:{learnHow:l.a.urlBag.verificationCodeHelp,recovery:"#",disclaimer:l.a.urlBag.accountRecoveryHelp},title:p.a.getString("verifyDeviceShowHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}},noIforgotOptions:{title:p.a.getString("noIforgotHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}}},dialogClick:function(){this.attr("showHelpDialog",!1),this.attr("showNoIforgotHelpDialog",!1)},accRecoveryClick:function(e){var t,o=this;return(t=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=o,t.next=3,M(e,n,O);case 3:n.attr("showNoIforgotHelpDialog",!1),n.attr("dialog.moreVerificationOptions.links.recovery","#");case 5:case"end":return t.stop()}}),t)})),function(){var e=this,o=arguments;return new Promise((function(n,r){var i=t.apply(e,o);function a(e){C(i,n,r,a,s,"next",e)}function s(e){C(i,n,r,a,s,"throw",e)}a(void 0)}))})()},suppressIforgotDialog:function(){this.attr("showAlternateOptions",!1),this.attr("showNoIforgotHelpDialog",!0)},recoveryNotAvailableClick:function(){this.attr("showHelpDialog",!0)}},events:{inserted:function(e,t){var o,n;this.viewModel.attr("phones",l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers),this.spinner=h.a,o=this.viewModel.phones,n=function(e){-1!==l.a.twoSV.supportedPushModes.indexOf(e.pushMode)&&("voice"===e.pushMode?e.attr("lastUsedPushModeText",p.a.getString("voiceCall")):"sms"===e.pushMode&&e.attr("lastUsedPushModeText",p.a.getString("textMsg")))},1===o.length?n(o[0]):r.a.each(o,(function(e,t){n(o[t])})),e.find("[tabindex=-1]")&&a()(e.find("[tabindex=-1]")[0]).focus()},".si-phone-row mouseup":function(e,t){if(1===t.which){this.viewModel.attr("selectedPhone",P(e.attr("phone-id"),this.viewModel.phones)),this.viewModel.selectedPhone.attr("selected",!0)}},".si-phone-row click":function(e,t){var o=this;setTimeout((function(){o.viewModel.attr("hideChev",!0),o.viewModel.selectedPhone.attr("selected",!1),o.spinner.start(a()(".arrow[data-id="+o.viewModel.selectedPhone.id+"]")),T(o.viewModel,!0),u.sendNewCode(o.viewModel.selectedPhone.id,o.viewModel.selectedPhone.pushMode).done((function(e,t,n){o.element.trigger("phoneSelected",[e])})).fail((function(e){423===e.status&&(o.viewModel.attr("lastCodeSentTo",o.viewModel.phones[0]),o.viewModel.attr("lastCodeSentTo.tooManyCodesSentLockObject",e.responseJSON)),O(e,o.viewModel)})).always((function(e,t,n){T(o.viewModel,!1),o.viewModel.attr("hideChev",!1),o.spinner.stop()}))}),200)},".error click":function(e,t){this.viewModel.attr("errorMessage","")},'[role="button"] focus':function(e,t){this.viewModel.attr("selectedPhone",P(e.attr("phone-id"),this.viewModel.phones))},"{viewModel} errorMessage":function(){if(this.viewModel.errorMessage){var e=this;setTimeout((function(){a()(".error",e.element).focus()}),1e3)}}}}),o(138),o(137),o(154),o(123)),x=o(41),N=o(160),D=o(573),A=o.n(D),V=o(17),j=o(89),H=(o(302),function(e,t){var o=a()(t),n=o.viewModel(),r=Object(f.a)(e.responseJSON,p.a.getString("fallback")),i=r.message;switch(e.status){case 400:Object(j.a)(r.code)?a()("hsa2").trigger("authFailed",r):n.attr("errorMessage",i);break;case 409:o.trigger("next_409",[e]);break;case 423:r.status.isTooManyCodesSent?(n.attr("errorMessage",p.a.getString("tooManyCodesSent")),n.attr("tooManyCodesSent")&&n.attr("tooManyCodesSent",!0)):r.status.isTooManyCodesValidated||r.status.isSecurityCodeLocked?n.attr("errorMessage",p.a.getString("securityCodeLocked")):n.attr("errorMessage",r.message);break;case 412:if(!e.getResponseHeader("location")){n.attr("errorMessage",locMessage("web.error.unknown.description"));break}o.trigger("repairAppleID",[e]),n.attr("isRepair",!0);break;default:n.attr("errorMessage",i)}});function F(e,t,o,n,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(n,r)}function I(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){F(i,n,r,a,s,"next",e)}function s(e){F(i,n,r,a,s,"throw",e)}a(void 0)}))}}var L=425,R=412,U=function(e){e.element.find(".char-field").val(""),e.viewModel.attr("verifyCode",""),e.element.find(".char-field").first().focus()},B=(r.a.Component.extend({tag:"verify-phone",template:r.a.view(A.a),viewModel:{define:{supportPin:{type:"object",value:function(){return{}}},authType:{type:"string",get:function(){return Object(s.a)(l.a,"authType")}},btnList:{type:"object",value:function(){var e=this;return{supportPin:{isDisabled:!1,btnText:p.a.getString("supportPinBtnText"),clickHandler:function(){e.attr("dialogType","generatePinDialog")}}}}},appleIdLinkTarget:{type:"string",value:function(){return l.a.appleIdLinkTarget}},recoveryNotAvailableLink:{type:"boolean",get:function(){return!(!this.attr("twoFactorVerificationSupportUrl")||this.attr("recoveryAvailable"))}},showMoreInformationDialog:{type:"boolean",value:!1}},dialogType:"verification",generatePinClickHandler:function(){var e=this;return I(regeneratorRuntime.mark((function t(){var o,n,r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=e,n="",r="",t.prev=1,o.attr("showSpinner","true"),t.next=5,N.a.getPin();case 5:i=t.sent,o.supportPin.attr("PIN",i.data.pin),n=i.data.date,r=p.a.getString("web.date.time.format.LT"),o.supportPin.attr("validUntil",k.a.formatDateTime({dateTimeISOString:n,momentFormatType:r,isUTCFormat:!0})),o.attr("showSpinner","false"),o.attr("dialogType","supportPinSuccess"),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(1),o.attr("showSpinner","false"),o.attr("dialogType","couldNotGenerateSupportPin");case 20:case"end":return t.stop()}}),t,null,[[1,15]])})))()},dialogClick:function(e,t){this.attr("showHelpDialog",!1),this.attr("showNoIforgotHelpDialog",!1),e===x.a.getHashCode(p.a.getString("btnTextGeneratePin").trim().toLowerCase())||e===x.a.getHashCode(p.a.getString("btnTextGenerateNewPin").trim().toLowerCase())?this.generatePinClickHandler():e===x.a.getHashCode(p.a.getString("btnTextDone").trim().toLowerCase())||e===x.a.getHashCode(p.a.getString("okText").trim().toLowerCase())?a()("hsa2").trigger("authFailed"):e===x.a.getHashCode(p.a.getString("btnTextGoBack").trim().toLowerCase())&&this.attr("dialogType","verification")},dialogClosed:function(){this.attr("isRepair")||a()("sa").trigger("authFailed")},generatePinDialog:{title:p.a.getString("titleGeneratePin"),btnOpts:{btnTexts:[p.a.getString("btnTextGoBack"),p.a.getString("btnTextGeneratePin")],direction:"center"}},generateNewPinDialog:{title:p.a.getString("titleGeneratePin"),btnOpts:{btnTexts:[p.a.getString("btnTextGenerateNewPin"),p.a.getString("btnTextDone")],direction:"center"}},couldNotGenerateSupportPinDialog:{title:p.a.getString("titleCanNotGeneratePin"),btnOpts:{btnTexts:[p.a.getString("okText")],direction:"center"}},twoFactorVerificationSupportUrl:"",mode:Object(s.a)(l.a,"envConfigFromConsumer.authUIMode"),recoveryAvailable:!0,codeSentToPhone:null,verifyCode:"",errorMessage:"",codeLength:null,usedPushMode:"",localisedDigit:p.a.getString("localisedDigit"),allow:{verifyCode:!1},showSpinnerFor:{verifyingCode:!1,sendingCode:!1,calling:!1},otherOptionsClicked:!1,showAlternateOptions:!1,showHelpDialog:!1,showNoIforgotHelpDialog:!1,isRepair:!1,dialog:{moreVerificationOptions:{links:{learnHow:l.a.urlBag.verificationCodeHelp.trim(),recovery:"#",disclaimer:l.a.urlBag.accountRecoveryHelp.trim()},title:p.a.getString("verifyDeviceShowHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}},noIforgotOptions:{title:p.a.getString("noIforgotHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}}},suppressIforgot:null,hasMoreThanOneTrustedPhoneNumbers:!1,viewportWidth:window.innerWidth<=L||window.innerHeight<=R?"small":"large",accRecoveryClick:function(e){var t=this;return I(regeneratorRuntime.mark((function o(){var n;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return n=t,o.next=3,M(e,n,(function(e,t){return H(e,"verify-phone")}));case 3:n.attr("showHelpDialog",!1),n.attr("showNoIforgotHelpDialog",!1),n.attr("showAlternateOptions",!1),n.attr("dialog.moreVerificationOptions.links.recovery","#");case 7:case"end":return o.stop()}}),o)})))()},suppressIforgotDialog:function(){return this.attr("showAlternateOptions",!1),this.attr("showNoIforgotHelpDialog",!0),!1},recoveryNotAvailableClick:function(){return this.attr("showAlternateOptions",!1),this.attr("showHelpDialog",!0),!1},moreInformationClick:function(e){e.preventDefault(),this.attr("showMoreInformationDialog",!0)}},events:{inserted:function(e,t){this.spinner=h.a;var o=this.viewModel;if(o.lastCodeSentToPhone&&""!==o.lastCodeSentToPhone.errorMessage)o.attr("errorMessage",o.lastCodeSentToPhone.errorMessage),o.attr("codeSentToPhoneNumber","restricted"===o.attr("authType")?o.lastCodeSentToPhone.numberWithDialCode:o.lastCodeSentToPhone.obfuscatedNumber),o.attr("usedPushMode",o.lastCodeSentToPhone.pushMode),o.attr("codeLength",6),o.codeSentToPhone&&o.codeSentToPhone.securityCode&&o.codeSentToPhone.securityCode.tooManyCodesSent&&o.attr("tooManyCodesSent",o.codeSentToPhone.securityCode.tooManyCodesSent);else if(o.codeSentToPhone&&o.codeSentToPhone.securityCode){var n=o.codeSentToPhone.serviceErrors||o.codeSentToPhone.service_errors||o.codeSentToPhone.validationErrors;void 0!==n&&(n.length>0?(o.attr("errorMessage",n[0].message),o.codeSentToPhone.securityCode.tooManyCodesSent&&o.attr("tooManyCodesSent",!0)):o.attr("errorMessage",p.a.getString("fallback"))),o.attr("codeSentToPhoneNumber","restricted"===o.attr("authType")?o.codeSentToPhone.phoneNumber.numberWithDialCode:o.codeSentToPhone.phoneNumber.obfuscatedNumber),o.attr("usedPushMode",o.codeSentToPhone.phoneNumber.pushMode),o.codeSentToPhone.securityCode.length&&""!==o.codeSentToPhone.securityCode.length?o.attr("codeLength",o.codeSentToPhone.securityCode.length):o.attr("codeLength",6)}o.attr("hasMoreThanOneTrustedPhoneNumbers",l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.length>1)}," keyup":function(e,t){27===t.which&&(this.viewModel.showAlternateOptions||this.viewModel.attr("showMoreInformationDialog"))&&(this.viewModel.attr("showAlternateOptions",!1),this.viewModel.attr("showMoreInformationDialog",!1),this.viewModel.otherOptionsClicked&&this.viewModel.attr("otherOptionsClicked",!1))},"security-code completed":function(e,t,o){var n;Object(V.f)(["authSecondFactor"]),this.viewModel.attr("verifyCode",o),(n=this).viewModel.attr("errorMessage",""),n.viewModel.attr("showSpinnerFor.verifyingCode",!0),Object(V.f)(["authSecondFactor","verifyPhoneCalled"]),n.viewModel.tooManyCodesSent&&n.viewModel.lastCodeSentToPhone?u.verifyPhone(n.viewModel.lastCodeSentToPhone.id,n.viewModel.verifyCode,n.viewModel.lastCodeSentToPhone.tooManyCodesSentLockObject.mode).done((function(e,t,o){Object(V.e)(["authSecondFactor","verifyPhoneCalled"]),n.element.trigger("authCompleted",[o])})).fail((function(e,t,o){U(n),n.viewModel.attr("showSpinnerFor.verifyingCode",!1),H(e,"verify-phone")})):u.verifyPhone(n.viewModel.codeSentToPhone.phoneNumber.id,n.viewModel.verifyCode,n.viewModel.codeSentToPhone.phoneNumber.pushMode).done((function(e,t,o){Object(V.e)(["endAuthSecondFactor","verifyPhoneCalled"]),n.element.trigger("authCompleted",[o])})).fail((function(e,t,o){U(n),n.viewModel.attr("showSpinnerFor.verifyingCode",!1),H(e,"verify-phone")}))},".char-field keypress":function(e,t){this.viewModel.attr("errorMessage","")},"#didnt-get-code click":function(e,t){return this.viewModel.attr("showAlternateOptions",!this.viewModel.showAlternateOptions),this.viewModel.attr("showMoreInformationDialog",!1),!1},"#use-diff-ph click":function(e,t){return this.element.trigger("usePhone"),!1},"#other-opts click":function(e,t){return this.viewModel.attr("otherOptionsClicked",!this.viewModel.otherOptionsClicked),this.viewModel.attr("showAlternateOptions",!this.viewModel.showAlternateOptions),!1},".error click":function(e,t){this.viewModel.attr("errorMessage","")},"#try-again click":function(e,t){var o=this;return o.viewModel.attr("errorMessage",""),setTimeout((function(){o.viewModel.attr("showSpinnerFor.calling",!0),u.sendNewCode(o.viewModel.codeSentToPhone.phoneNumber.id,o.viewModel.codeSentToPhone.phoneNumber.pushMode).done((function(e,t,o){})).fail((function(e){H(e,"verify-phone")})).always((function(e,t,n){o.viewModel.attr("showSpinnerFor.calling",!1),o.viewModel.attr("showAlternateOptions",!1),o.viewModel.attr("showMoreInformationDialog",!1)}))}),300),!1},"#call-me click":function(e,t){var o=this;return o.viewModel.attr("errorMessage",""),o.viewModel.attr("showAlternateOptions",!1),o.element.find(".char-field").first().focus(),setTimeout((function(){o.viewModel.attr("showSpinnerFor.sendingCode",!0),u.sendNewCode(o.viewModel.codeSentToPhone.phoneNumber.id,"voice").done((function(e,t,n){o.viewModel.attr("codeSentToPhone",e),o.viewModel.attr("usedPushMode","voice")})).fail((function(e){H(e,"verify-phone")})).always((function(e,t,n){o.viewModel.attr("showSpinnerFor.sendingCode",!1)}))}),300),!1},"#sms-me click":function(e,t){var o=this;return o.viewModel.attr("errorMessage",""),o.viewModel.attr("showAlternateOptions",!1),o.element.find(".char-field").first().focus(),setTimeout((function(){o.viewModel.attr("showSpinnerFor.sendingCode",!0),u.sendNewCode(o.viewModel.codeSentToPhone.phoneNumber.id,"sms").done((function(e,t,n){o.viewModel.attr("codeSentToPhone",e),o.viewModel.attr("usedPushMode","sms")})).fail((function(e){H(e,"verify-phone")})).always((function(e,t,n){o.viewModel.attr("showSpinnerFor.sendingCode",!1)}))}),300),!1},"idms-modal modalClose":function(e,t){this.viewModel.attr("showHelpDialog",!1),this.viewModel.attr("showNoIforgotHelpDialog",!1),this.viewModel.attr("showMoreInformationDialog",!1)},"{scope} showSpinnerFor.verifyingCode":function(e,t,o){o?this.spinner.start(a()("#verifying-code"),"small"):this.spinner.stop()},"{scope} showAlternateOptions":function(e,t,o,n){o||this.viewModel.attr("otherOptionsClicked",!1)},"{scope} showSpinnerFor.sendingCode":function(e,t,o){o?this.spinner.start(a()("#sending-code"),"small"):this.spinner.stop()}}}),function(){});(B.prototype=new c.a).constructor=B,B.prototype.pushAuthCode=function(e){return this.put({url:l.a.urlContext+e})};var _=new B,J=o(574),E=o.n(J);function G(e,t,o,n,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(n,r)}var q,W=425,K=412,X=function(e,t){var o=a()("verify-device"),n=Object(f.a)(e.responseJSON),r=Object(f.a)(e.responseJSON,p.a.getString("fallback")).message;switch(e.status){case 400:Object(j.a)(n.code)?a()("hsa2").trigger("authFailed",n):t.attr("errorMessage",r);break;case 409:o.trigger("next_409",[e]);break;case 423:n.status.isTooManyCodesSent?t.attr("errorMessage",p.a.getString("tooManyCodesSent")):n.status.isTooManyCodesValidated||n.status.isSecurityCodeLocked?t.attr("errorMessage",p.a.getString("securityCodeLocked")):t.attr("errorMessage",n.message);break;case 412:if(!e.getResponseHeader("location")){t.attr("errorMessage",Object(p.b)("web.error.unknown.description"));break}o.trigger("repairAppleID",[e]),t.attr("isRepair",!0);break;default:t.attr("errorMessage",r)}},z=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_.pushAuthCode("/auth/verify/trusteddevice/securitycode").fail((function(t,o,n){e.viewModel.attr("allow.resendCode",!(423===t.status)),X(t,e.viewModel)})).always((function(){e.viewModel.attr("showAlternateOptions",t),e.element.find(".char-field").first().focus()}))},Q=(r.a.Component.extend({tag:"verify-device",template:r.a.view(E.a),viewModel:{define:{appleIdLinkTarget:{type:"string",value:function(){return l.a.appleIdLinkTarget}},recoveryNotAvailableLink:{type:"boolean",get:function(){return!(!this.attr("twoFactorVerificationSupportUrl")||this.attr("recoveryAvailable"))}}},mode:Object(s.a)(l.a,"envConfigFromConsumer.authUIMode"),twoFactorVerificationSupportUrl:"",recoveryAvailable:!0,verifyCode:"",errorMessage:"",codeLength:null,allow:{verifyCode:!1,resendCode:!0,sendText:!0},suppressIforgot:null,showSpinnerFor:{verifyingCode:!1,gettingRecoveryPath:!1},showAlternateOptions:!1,localisedDigit:p.a.getString("localisedDigit"),lastUsedPushMode:"",hasOnlyOneTrustedPhoneNumber:!1,showHelpDialog:!1,isRepair:!1,dialogClick:function(){this.attr("showHelpDialog",!1),this.attr("showNoIforgotHelpDialog",!1)},dialog:{moreVerificationOptions:{links:{learnHow:l.a.urlBag.verificationCodeHelp,recovery:"#",disclaimer:l.a.urlBag.accountRecoveryHelp},title:p.a.getString("verifyDeviceShowHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}},noIforgotOptions:{title:p.a.getString("noIforgotHelpDialogTitle"),titleAlign:"center",bodyAlign:"left",showAppleLogo:!1,theme:"translucent",btnOpts:{btnList:[{btnText:p.a.getString("okText"),isDisabled:!1,isPrimaryButton:!0,id:"ok-text-".concat(Object(S.a)())}],direction:"center"}}},viewportWidth:window.innerWidth<=W||window.innerHeight<=K?"small":"large",accRecoveryClick:function(e){var t,o=this;return(t=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=o).attr("showSpinnerFor.gettingRecoveryPath",!0),t.next=4,M(e,n,X);case 4:n.attr("showHelpDialog",!1),n.attr("showSpinnerFor.gettingRecoveryPath",!1),n.attr("showNoIforgotHelpDialog",!1),n.attr("showAlternateOptions",!1),a()("security-code").find(".char-field").first().focus(),n.attr("dialog.moreVerificationOptions.links.recovery","#");case 10:case"end":return t.stop()}}),t)})),function(){var e=this,o=arguments;return new Promise((function(n,r){var i=t.apply(e,o);function a(e){G(i,n,r,a,s,"next",e)}function s(e){G(i,n,r,a,s,"throw",e)}a(void 0)}))})()},suppressIforgotDialog:function(){this.attr("showAlternateOptions",!1),this.attr("showNoIforgotHelpDialog",!0)},recoveryNotAvailableClick:function(){this.attr("showAlternateOptions",!1),this.attr("showHelpDialog",!0)}},events:{inserted:function(e,t){l.a.isResume2FA&&l.a.hasTrustedDevices&&z(this,!1),l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers&&this.viewModel.attr("hasOnlyOneTrustedPhoneNumber",1===l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.length),this.spinner=h.a,this.viewModel.hasOnlyOneTrustedPhoneNumber&&this.viewModel.attr("lastUsedPushMode",l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers[0].pushMode);var o=this.viewModel;this.element.find(".char-field").first().focus(),o.attr("codeLength",6)},keyup:function(e,t){27===t.which&&this.viewModel.showAlternateOptions&&this.viewModel.attr("showAlternateOptions",!1)},"security-code completed":function(e,t,o){var n;Object(V.f)(["authSecondFactor"]),this.viewModel.attr("verifyCode",o),(n=this).viewModel.attr("errorMessage",""),n.viewModel.attr("showSpinnerFor.verifyingCode",!0),Object(V.f)(["authSecondFactor","verifyDeviceCalled"]),u.verifyDevice(n.viewModel.verifyCode).done((function(e,t,o){Object(V.e)(["authSecondFactor","verifyDeviceCalled"]),n.element.trigger("authCompleted",[o])})).fail((function(e,t,o){!function(e){e.element.find(".char-field").val(""),e.viewModel.attr("verifyCode",""),e.element.find(".char-field").first().focus()}(n),X(e,n.viewModel)})).always((function(){n.viewModel.attr("showSpinnerFor.verifyingCode",!1)}))},".char-field keyup":function(e,t){this.viewModel.attr("errorMessage","")},"#no-trstd-device-pop click":function(e,t){return this.viewModel.attr("showAlternateOptions",!this.viewModel.showAlternateOptions),this.viewModel.attr("showAlternateOptions")||this.element.find(".char-field").first().focus(),!1},"#use-phone click":function(e,t){var o=l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers,n=this;return 1===o.length?u.sendNewCode(o[0].id,o[0].pushMode).done((function(e){n.element.trigger("codeSent",[e])})).fail((function(e){n.viewModel.attr("allow.sendText",!(423===e.status)),n.viewModel.attr("showAlternateOptions",!1),X(e,n.viewModel)})).always((function(e){})):n.element.trigger("usePhone"),!1},"#try-again click":function(e,t){return z(this,!1),!1},".error click":function(e,t){this.viewModel.attr("errorMessage","")},"idms-modal modalClose":function(e,t){this.viewModel.attr("showHelpDialog",!1),this.element.find(".char-field").first().focus(),this.viewModel.attr("showNoIforgotHelpDialog",!1)},"{viewModel} showSpinnerFor.verifyingCode":function(e,t,o){o?this.spinner.start(a()("#verifying-code"),"small"):this.spinner.stop()},"{viewModel} showSpinnerFor.gettingRecoveryPath":function(e,t,o){o?this.spinner.start(a()("#getting-recovery-path")):this.spinner.stop()}}}),o(229),o(70),o(575)),Y=o.n(Q),Z=o(71),$=o(166);function ee(e,t,o,n,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void o(e)}s.done?t(c):Promise.resolve(c).then(n,r)}function te(e){return function(){var t=this,o=arguments;return new Promise((function(n,r){var i=e.apply(t,o);function a(e){ee(i,n,r,a,s,"next",e)}function s(e){ee(i,n,r,a,s,"throw",e)}a(void 0)}))}}function oe(){return(oe=te(regeneratorRuntime.mark((function e(t){var o,n,r,i,a,c,l,d,u=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=u.length>1&&void 0!==u[1]&&u[1],e.prev=1,t.viewModel.attr("errorMessage",""),t.viewModel.attr("domErrorMessage",""),t.viewModel.attr("showSpinner",!0),t.viewModel.attr("forceAuth",o),n=t.viewModel.attr("fsaVerification.fsaChallenge").serialize(),r=n.challenge,i=n.keyHandles,a=n.rpId,e.next=9,Object(Z.c)({challenge:r,rpId:a,isUserVerificationRequired:!1,keyHandles:i,useBase64Url:!1});case 9:return c=e.sent,l=Object(Z.b)(c,a,void 0,!1),e.next=13,$.a.verifyClientAssertion(l);case 13:d=e.sent,t.element.trigger("authCompleted",Object(s.a)(d,"jqXHR")),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),e.t0 instanceof DOMException?"NotAllowedError"!==e.t0.name?t.viewModel.attr("errorMessage",p.a.getString("fallback")):e.t0.message&&t.viewModel.attr("domErrorMessage",e.t0.message):H(Object(s.a)(e.t0,"jqXHR",{}),"verify-key");case 20:t.viewModel.attr("showSpinner",!1);case 21:case"end":return e.stop()}}),e,null,[[1,17]])})))).apply(this,arguments)}r.a.Component.extend({tag:"verify-key",template:r.a.view(Y.a),viewModel:{define:{isWebAuthnSupported:{value:function(){return Object(Z.d)()}},appDomain:{value:function(){var e=Object(s.a)(l.a,"destinationDomain","");return e?new URL(e).hostname:""}}},mode:Object(s.a)(l.a,"envConfigFromConsumer.authUIMode"),errorMessage:"",domErrorMessage:"",showSpinner:!1,forceAuth:!1,fsaVerification:{},doKeyAssertion:function(){!function(e){oe.apply(this,arguments)}(q)}},events:{inserted:function(e){q=this,e.find("[tabindex=-1]")&&a()(e.find("[tabindex=-1]")[0]).focus(),this.spinner=h.a}}}),o(304);var ne=o(576),re=o.n(ne),ie=function(e,t,o){e.attr("lastCodeSentToPhone",o),t.responseJSON?e.attr("codeSentToPhone",t.responseJSON):e.attr("codeSentToPhone",t),e.attr("section","verifyPhone")},ae=function(e,t){l.a.is2SVTrustEligible&&!e.viewModel.attr("skipTrustBrowserStep")?(t&&e.viewModel.attr("xhr",t),e.viewModel.attr("section","trustMyBrowser")):e.element.trigger("authSuccess",t)},se=r.a.Component.extend({tag:"hsa2",template:r.a.view(re.a),viewModel:{define:{twoFactorVerificationSupportUrl:{type:"string",value:function(){return Object(s.a)(l.a,"twoSV.phoneNumberVerification.twoFactorVerificationSupportUrl","")}},recoveryAvailable:{type:"boolean",get:function(){var e=!0;return Object(s.a)(l.a,"twoSV.phoneNumberVerification.hasRecoveryKey",!1)&&!Object(s.a)(l.a,"twoSV.phoneNumberVerification.supportsRecoveryKey",!1)&&(e=!1),e}},suppressCompletionSpinner:{type:"boolean",get:function(){return"FALSE"===Object(s.a)(l.a,"envConfigFromConsumer.waitAnimationOnAuthComplete",!1).toString().trim().toUpperCase()}},fsaVerification:{type:"object",get:function(){return Object(s.a)(l.a,"twoSV.fsaVerification",{})}}},section:"",selectedPhone:null,xhr:null,suppressIforgot:!1,fsaVerification:null},init:function(e,t){Object(V.f)(["loadHSA2Component"])},events:{inserted:function(){Object(V.e)(["authFirstFactor"]),"managed"===l.a.authType&&this.viewModel.attr("suppressIforgot",!0),this.element.trigger("__inserted"),l.a.hasTrustedDevices?this.viewModel.attr("section","verifyDevice"):l.a.twoSV.phoneNumberVerification?l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers?0===l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.length||(1===l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.length?ie(this.viewModel,l.a.twoSV.phoneNumberVerification):l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.length>1&&this.viewModel.attr("section","phones")):(l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers=[],l.a.twoSV.phoneNumberVerification.trustedPhoneNumbers.push(l.a.twoSV.phoneNumberVerification),ie(this.viewModel,l.a.twoSV.phoneNumberVerification)):l.a.twoSV.fsaVerification&&l.a.twoSV.authFactors&&"fsa2_hsa2"===l.a.twoSV.authFactors[0]&&this.viewModel.attr("section","verifyKey")},"{viewModel} section":function(){this.element.trigger("section",[this.viewModel.attr("section")])},"phones phoneSelected":function(e,t,o,n){ie(this.viewModel,o,n)},"verify-phone authCompleted":function(e,t,o){ae(this,o)},"verify-key authCompleted":function(e,t,o){ae(this,o)},"verify-phone next_409":function(e,t,o){this.element.trigger("next_409",[o])},"verify-phone noTrustedPhones":function(e,t){this.viewModel.attr("section","phones")},"verify-phone usePhone":function(e,t){this.viewModel.attr("section","phones")},"verify-device codeSent":function(e,t,o){ie(this.viewModel,o)},"verify-device authCompleted":function(e,t,o){ae(this,o)},"verify-device usePhone":function(e,t){this.viewModel.attr("section","phones")},"verify-device next_409":function(e,t,o){this.element.trigger("next_409",[o])},"trust-browser complete":function(e,t,o){o?this.element.trigger("authSuccess",o):this.element.trigger("authSuccess",this.viewModel.xhr)}}});t.default=se},572:function(e,t){e.exports="jstache_527586407"},573:function(e,t){e.exports="jstache_1491168329"},574:function(e,t){e.exports="jstache_1947113137"},575:function(e,t){e.exports="jstache_51766776"},576:function(e,t){e.exports="jstache_19243547"},70:function(e,t){e.exports=Detectizr}},[[1012,1,0]]]);
